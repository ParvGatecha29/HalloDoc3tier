@model HalloDocDAL.Model.AdminDashboardData
@using Microsoft.AspNetCore.Http
@{
    ViewData["Title"] = "View Case";
    Layout = "_adminDash";
}

@functions {
    public string GetReqType(int RequstTypeId)
    {
        switch (RequstTypeId)
        {
            case 1: return "Patient";   
            case 2: return "Family";
            case 3: return "Concierge";
            case 4: return "Business";
            default: return "Unknown";
        }
    }
    public string GetTableColorClass(int RequstTypeId)
    {
        switch (RequstTypeId)
        {
            case 1: return "green";
            case 2: return "orange";
            case 3: return "blue";
            case 4: return "pink";
            default: return "green";
        }
    }
    public string okok(int Status)
    {
        switch (Status)
        {
            case 1: return "New";
            case 2: return "Pending";
            case 3: return "Active";
            case 4: return "Conclude";
            case 5: return "To Close";
            case 6: return "Unpaid";
            default: return "New";
        }
    }
}

<div class="container">
    <div class=" mt-5 d-flex justify-content-between align-items-center">
        <h4>@okok(Convert.ToInt32(@Model.status)) Profile <span class="badge rounded-5 Reqtyp" style="background-color:@GetTableColorClass(@Model.requesttype)">@GetReqType(Model.requesttype) </span></h4>

        <a asp-controller="AdminDashboard" asp-action="AdminDashboard"
            class="btn shadow  btn-outline-secondary border-info text-info px-3 ">
            <i class="fa-solid fa-angle-left"></i> Back
        </a>
    </div>
    <form action="" class="shadow border rounded my-3" method="post">
        <div class="mx-3 my-4 ">
            <div class="mt-3">
                <h4 class="ms-auto me-auto mb-4">Patient Information</h4>
                <h6 style="font-size: 14px">Confirmation Number</h6>
                <p class="text-info fs-5 mb-3">@Model.confirmationNo</p>

                <div class="row">
                    <div class=" col-12 form-floating mb-3 ">
                        <textarea class="form-control h-100" id="floatingInput" placeholder=" " rows="3"
                            disabled asp-for="@Model.notes" ></textarea>
                        <label for="floatingInput" class="floating-label text-wrap ms-2">Patient Notes</label>
                    </div>
                </div>
                <hr />
                <div class="mt-1">
                    <div class="row">

                        <div class="form-floating mb-3 col-12 col-sm-6">
                            <input type="text" class="form-control " id="floatingInput" placeholder="John"
                                required disabled asp-for="@Model.firstName">
                            <label for="floatingInput" class="floating-label ms-2 ">First Name</label>
                        </div>

                        <div class="form-floating mb-3 col-12 col-sm-6">
                            <input type="text" class="form-control " id="floatingInput" placeholder="Wick"
                                disabled asp-for="@Model.lastName">
                            <label for="floatingInput" class="floating-label ms-2 ">Last Name</label>
                        </div>

                        <div class="form-floating mb-3 col-12 col-sm-6">
                            <input type="date" class="form-control " id="floatingInput" placeholder="02-10-2002"
                                disabled />
                            <label for="floatingInput" class="floating-label ms-2 ">Date of Birth</label>
                        </div>
                        <div class="col-12 col-sm-5 z-3">
                            <div class="form-floating mb-3  h-100 ">
                                <input type="tel" class="phone form-control dclass h-100" id="floatingInput"
                                       placeholder=" " disabled asp-for="@Model.phone">
                            </div>
                        </div>

                        

                        <div class="form-floating mb-3 col-12 col-sm-1 ">
                            <button type="button" class="dclass btn btn-outline-dark border-info p-3 text-info w-100"style="height: 100%;">
                                <i class="bi bi-telephone"></i>
                            </button>
                        </div>

                    </div>

                </div>

                <div class="row">

                    <div class="form-floating mb-3 col-12 col-sm-6">
                        <input type="email" class="form-control emailInp dclass" id="floatingInput1"
                            mailto:placeholder="test@google.com" disabled asp-for="@Model.email">
                        <label for="floatingInput" class="floating-label ms-2 ">Email</label>
                    </div>
                    @*
                    <div
                    class="form-floating mb-3 col-12 col-sm-1 d-flex align-items-center justify-content-center mx-2">

                    <button type="button" id="editBtn" class="btn btn-outline-info EditBtn px-4 py-3"
                    onclick="enableFields()">Edit</button>
                    <button type="submit" id="submitBtn"
                    class="btn btn-outline-info EditBtn px-4 py-3">Save</button>
                    <button type="button" id="cancelBtn" class="btn btn-outline-info EditBtn px-4 py-3"
                    onclick="disableFields()">Cancel</button>
                    </div> *@

                </div>

                <div class="row">

                    <h4 class="ms-auto me-auto">Location Information</h4>


                    <div class="form-floating mb-3 col-12 col-sm-6">
                        <input type="text" class="form-control " id="floatingInput" placeholder="Maryland"
                            disabled>
                        <label for="floatingInput" class="floating-label ms-2 ">Region</label>
                    </div>

                    <div class="form-floating mb-3 col-12 col-sm-5">
                        <input type="text" class="form-control " id="floatingInput" placeholder="Maryland"
                            disabled asp-for="@Model.address">
                        <label for="floatingInput" class="ms-2 floating-label">Business Name / Address</label>
                    </div>


                    <div class="form-floating mb-3 col-12 col-sm-1 ">
                        <button type="button" class="dclass btn btn-outline-dark border-info p-3 text-info w-100 "style="height: 100%;">
                            <i class="bi bi-geo-alt"></i>
                        </button>
                    </div>

                    <div class="form-floating mb-3 col-12 col-sm-6">
                        <input type="text" class="form-control " id="floatingInput" placeholder="007" disabled>
                        <label for="floatingInput" class="floating-label ms-2 ">Room #</label>
                    </div>

                </div>
                <div class="d-grid gap-2 d-flex justify-content-center  justify-content-md-end mt-4 pt-4 mb-3">
                    <button type="button" class="btn text-white btn-info">Assign</button>

                    <button type="button" class="btn text-white btn-info">View Notes</button>

                    <button type="button" class="btn text-white btn-danger cancelcase">Cancel</button>

                </div>

                @* <div class="d-grid gap-2 d-flex justify-content-center justify-content-md-end mt-4 pt-4 mb-3">

                <button type="button" id="editBtn" class="btn btn-info text-white EditBtn"
                onclick="enableFields()">Edit
                </button>

                <button type="submit" id="submitBtn" class="btn btn-info text-white EditBtn">Save</button>

                <button type="button" id="cancelBtn" class="btn btn-outline-info EditBtn"
                onclick="disableFields()">Cancel</button>
                </div> *@

            </div>
        </div>
    </form>
</div>
<div class="modal fade" id="cancelcaseModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-info">
                <h5 class="modal-title text-white" id="exampleModalLongTitle">Confirm Cancellation</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="form" method="post">
                    <p class="text-secondary"> Patient Name : <span class="text-info" id="cancelcaseName"> @Model.firstName @Model.lastName</span> </p>
                    <input type="hidden" value="@Model.requestId" name="requestId" id="requestId" />
                    <div class="form-group mb-3">
                        <select class="form-control" id="reason" name="reason" placeholder=" " required>
                            <option hidden value="">Reason for cancellation</option>
                            <option>No Response to call or text</option>
                            <option>Cost Issue</option>
                            <option>Insurance Issue</option>
                            <option>Out of service area</option>
                            <option>Not appropriate for service</option>
                            <option>Referral to Clinic or Hospital</option>
                        </select>
                    </div>

                    <div class="form-group mb-3">
                        <div class="mb-3 form-floating">
                            <textarea class="form-control" placeholder="" id="info" style="height: 100px" name="info" required></textarea>
                            <label for="info" class="floatingLabel"> Provide additional information </label>
                        </div>
                    </div>

                    <div class="text-end">
                        <button type="submit" class="btn btn-info text-white">Confirm</button>
                        <button type="button" class="btn border border-info text-info" data-bs-dismiss="modal">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $('#form').on('submit', function (e) {
            e.preventDefault();
            var data = new FormData(this)

            $.ajax({
                url: '@Url.Action("CancelCase","AdminDashboard")',
                type: 'POST',
                data: data,
                processData: false,
                contentType: false,
                success: function (result) {
                    if (result.success) {
                        Swal.fire({
                            title: "Good job!",
                            text: "Request cancelled succesfully",
                            icon: "success"
                        }).finally(() => {
                            window.location.reload();
                        });

                    }
                    else {
                        alert(result.message);
                    }
                },
                error: function () {
                    alert('An error occured');
                }
            });
        });
    });
</script>

<script>
    $(document).on("click", ".cancelcase", function () {
        $("#cancelcaseModal").modal('show');
        // $("#cancelcaseName").text(@Model.firstName + @Model.lastName);
        // $("#requestId").val(@Model.requestId);
    });

</script>
@* <script>
function disableFields() {
document.querySelectorAll('.dclass').forEach(function (element) {
element.disabled = true;
});
// Hide the submit and cancel buttons, show the edit button
document.getElementById('submitBtn').style.display = 'none';
document.getElementById('cancelBtn').style.display = 'none';
document.getElementById('editBtn').style.display = 'block';
}

function enableFields() {
document.querySelectorAll('.dclass').forEach(function (element) {
element.disabled = false;
});
// Show the submit and cancel buttons, hide the edit button
document.getElementById('submitBtn').style.display = 'block';
document.getElementById('cancelBtn').style.display = 'block';
document.getElementById('editBtn').style.display = 'none';
}
disableFields();
</script>  *@